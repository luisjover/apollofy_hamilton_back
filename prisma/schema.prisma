// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mongodb"
  url      = env("MONGODB_URL")
}

//libraList es un array de strings que solo contiene los ids de albums, artists o playList
model Users {
  id           String       @id @default(auto()) @map("_id") @db.ObjectId
  userName     String
  email        String       @unique
  imageUrl     String?
  createdAt    DateTime     @default(now())
  updatedAt    DateTime     @updatedAt
  trackList    Tracks[]
  favourites   Favourites[]
  usersId      String?      @db.ObjectId
  playList     PlayLists[]
  type         String
  followers    Users[]      @relation("UserFollows", fields: [followersIds], references: [id])
  followersIds String[]     @db.ObjectId
  following    Users[]      @relation("UserFollows", fields: [followingIds], references: [id])
  followingIds String[]     @db.ObjectId
}

model Favourites {
  id        String     @id @default(auto()) @map("_id") @db.ObjectId
  artist    Artists?
  album     Albums?
  playlists PlayLists?
  Users     Users?     @relation(fields: [usersId], references: [id])
  usersId   String?    @db.ObjectId
}

model Artists {
  id           String      @id @default(auto()) @map("_id") @db.ObjectId
  name         String
  genres       String[]
  imageUrl     String
  imageId      String
  popularity   Int
  albumsId     String[]    @db.ObjectId
  albums       Albums[]    @relation(fields: [albumsId], references: [id])
  listType     String
  Tracks       Tracks?     @relation(fields: [tracksId], references: [id])
  tracksId     String?     @db.ObjectId
  isTopTrend   Boolean
  favourites   Favourites? @relation(fields: [favouritesId], references: [id])
  favouritesId String?     @unique @db.ObjectId
  TopArtists   TopArtists? @relation(fields: [topArtistsId], references: [id])
  topArtistsId String?     @db.ObjectId
}

model Albums {
  id           String      @id @default(auto()) @map("_id") @db.ObjectId
  name         String
  genres       String[]
  imageUrl     String
  popularity   Int
  artistId     String[]    @db.ObjectId
  artists      Artists[]   @relation(fields: [artistId], references: [id])
  tracks       Tracks[]
  listType     String
  isTopTrend   Boolean
  favourites   Favourites? @relation(fields: [favouritesId], references: [id])
  favouritesId String?     @unique @db.ObjectId
  TopAlbums    TopAlbums?  @relation(fields: [topAlbumsId], references: [id])
  topAlbumsId  String?     @db.ObjectId
}

model PlayLists {
  id             String        @id @default(auto()) @map("_id") @db.ObjectId
  name           String
  imageUrl       String
  tracks         Tracks[]
  description    String
  owner          Users         @relation(fields: [usersId], references: [id])
  privacity      Boolean
  listType       String
  isTopTrend     Boolean
  createdAt      DateTime      @default(now())
  updatedAt      DateTime      @updatedAt
  usersId        String        @db.ObjectId
  favourites     Favourites?   @relation(fields: [favouritesId], references: [id])
  favouritesId   String?       @unique @db.ObjectId
  TopPlaylists   TopPlaylists? @relation(fields: [topPlaylistsId], references: [id])
  topPlaylistsId String?       @db.ObjectId
}

model Genres {
  id       String   @id @default(auto()) @map("_id") @db.ObjectId
  name     String
  imageUrl String?
  tracksId String[] @db.ObjectId
  tracks   Tracks[] @relation(fields: [tracksId], references: [id])
  color    String?
}

model Tracks {
  id         String     @id @default(auto()) @map("_id") @db.ObjectId
  name       String
  imageUrl   String
  artists    Artists[]
  likes      Int
  genresId   String[]   @db.ObjectId
  genres     Genres[]   @relation(fields: [genresId], references: [id])
  audioUrl   String
  verified   Boolean
  privacity  Boolean
  duration   Int?
  imageId    String
  audioId    String
  album      Albums?    @relation(fields: [albumsId], references: [id])
  albumsId   String?    @db.ObjectId
  Users      Users?     @relation(fields: [usersId], references: [id])
  usersId    String?    @db.ObjectId
  PlayList   PlayLists? @relation(fields: [playListId], references: [id])
  playListId String?    @db.ObjectId
}

model TopArtists {
  id         String    @id @default(auto()) @map("_id") @db.ObjectId
  topArtists Artists[]
}

model TopAlbums {
  id        String   @id @default(auto()) @map("_id") @db.ObjectId
  topAlbums Albums[]
}

model TopPlaylists {
  id           String      @id @default(auto()) @map("_id") @db.ObjectId
  topPLaylists PlayLists[]
}
